---
phase: 01-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - worker/src/routes/projects.ts
  - worker/src/index.ts
  - frontend/src/pages/Dashboard.tsx
  - frontend/src/pages/ProjectForm.tsx
  - frontend/src/hooks/useProjects.ts
  - frontend/src/components/ProjectCard.tsx
  - frontend/src/App.tsx
autonomous: true

must_haves:
  truths:
    - "User can create a new project with client name, email, industry, date range"
    - "User can view list of their projects on dashboard"
    - "User can edit an existing project's details"
    - "User can soft-delete a project (marks deleted_at, hides from list)"
    - "Projects filtered to only show current user's projects"
    - "Deleted projects are excluded from project list"
  artifacts:
    - path: "worker/src/routes/projects.ts"
      provides: "Project CRUD API endpoints"
      exports: ["default"]
    - path: "frontend/src/pages/Dashboard.tsx"
      provides: "Project list with create button"
      min_lines: 50
    - path: "frontend/src/pages/ProjectForm.tsx"
      provides: "Create/edit project form"
      min_lines: 80
    - path: "frontend/src/hooks/useProjects.ts"
      provides: "React Query hooks for project operations"
      exports: ["useProjects", "useProject", "useCreateProject", "useUpdateProject", "useDeleteProject"]
    - path: "frontend/src/components/ProjectCard.tsx"
      provides: "Individual project display card"
      min_lines: 30
  key_links:
    - from: "worker/src/index.ts"
      to: "worker/src/routes/projects.ts"
      via: "app.route('/api/projects', projectRoutes)"
      pattern: "app\\.route.*projects"
    - from: "worker/src/routes/projects.ts"
      to: "worker/src/middleware/jwt.ts"
      via: "jwtAuth middleware on all routes"
      pattern: "app\\.use.*jwtAuth"
    - from: "frontend/src/hooks/useProjects.ts"
      to: "/api/projects"
      via: "apiFetch calls"
      pattern: "apiFetch.*projects"
    - from: "frontend/src/pages/Dashboard.tsx"
      to: "frontend/src/hooks/useProjects.ts"
      via: "useProjects hook"
      pattern: "useProjects"
---

<objective>
Implement complete project management system with CRUD API and dashboard UI.

Purpose: Enable staff to create, view, edit, and delete P&L projects. This satisfies PROJ-01 through PROJ-04 requirements. Projects serve as the container for all subsequent features (file uploads, transactions, reports).

Output: Working project management with dashboard showing project list, create/edit forms, and soft delete functionality.
</objective>

<execution_context>
@/Users/tungmbp1423/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tungmbp1423/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md (after Plan 01 completes)

Key patterns from research:
- Hono route organization with jwtAuth middleware
- Zod validation for request bodies
- React Query mutations with cache invalidation
- React Hook Form with Zod resolver
- Soft delete pattern using deleted_at column

Industries for dropdown (from PROJECT.md):
- Real Estate
- E-Commerce / Retail
- Medical / Healthcare
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create project API endpoints</name>
  <files>
    worker/src/routes/projects.ts
    worker/src/index.ts
  </files>
  <action>
Create worker/src/routes/projects.ts:
```typescript
import { Hono } from 'hono';
import { eq, and, isNull } from 'drizzle-orm';
import { z } from 'zod';
import type { Env } from '../index';
import { createDb } from '../db/client';
import { projects } from '../db/schema';
import { jwtAuth } from '../middleware/jwt';

const app = new Hono<{ Bindings: Env; Variables: { userId: number } }>();

// All routes require authentication
app.use('/*', jwtAuth);

// Validation schemas
const createProjectSchema = z.object({
  clientName: z.string().min(1, 'Client name is required').max(100),
  clientEmail: z.string().email('Invalid email address'),
  industry: z.enum(['real_estate', 'ecommerce', 'medical'], {
    errorMap: () => ({ message: 'Please select a valid industry' })
  }),
  periodStart: z.string().refine(val => !isNaN(Date.parse(val)), 'Invalid start date'),
  periodEnd: z.string().refine(val => !isNaN(Date.parse(val)), 'Invalid end date')
}).refine(data => new Date(data.periodStart) < new Date(data.periodEnd), {
  message: 'End date must be after start date',
  path: ['periodEnd']
});

const updateProjectSchema = createProjectSchema.partial();

// GET /api/projects - List user's projects
app.get('/', async (c) => {
  const userId = c.get('userId');
  const db = createDb(c.env.DB);

  const userProjects = await db.select()
    .from(projects)
    .where(and(
      eq(projects.userId, userId),
      isNull(projects.deletedAt)
    ))
    .orderBy(projects.createdAt);

  // Transform timestamps for JSON response
  const transformed = userProjects.map(p => ({
    ...p,
    periodStart: p.periodStart.toISOString(),
    periodEnd: p.periodEnd.toISOString(),
    createdAt: p.createdAt.toISOString(),
    updatedAt: p.updatedAt.toISOString()
  }));

  return c.json({ projects: transformed });
});

// GET /api/projects/:id - Get single project
app.get('/:id', async (c) => {
  const userId = c.get('userId');
  const projectId = parseInt(c.req.param('id'));

  if (isNaN(projectId)) {
    return c.json({ error: 'Invalid project ID' }, 400);
  }

  const db = createDb(c.env.DB);

  const project = await db.select()
    .from(projects)
    .where(and(
      eq(projects.id, projectId),
      eq(projects.userId, userId),
      isNull(projects.deletedAt)
    ))
    .get();

  if (!project) {
    return c.json({ error: 'Project not found' }, 404);
  }

  return c.json({
    project: {
      ...project,
      periodStart: project.periodStart.toISOString(),
      periodEnd: project.periodEnd.toISOString(),
      createdAt: project.createdAt.toISOString(),
      updatedAt: project.updatedAt.toISOString()
    }
  });
});

// POST /api/projects - Create new project
app.post('/', async (c) => {
  const userId = c.get('userId');
  const body = await c.req.json();

  const parsed = createProjectSchema.safeParse(body);
  if (!parsed.success) {
    return c.json({ error: parsed.error.issues[0].message }, 400);
  }

  const { clientName, clientEmail, industry, periodStart, periodEnd } = parsed.data;
  const db = createDb(c.env.DB);
  const now = new Date();

  const project = await db.insert(projects).values({
    userId,
    clientName,
    clientEmail,
    industry,
    periodStart: new Date(periodStart),
    periodEnd: new Date(periodEnd),
    status: 'active',
    createdAt: now,
    updatedAt: now
  }).returning().get();

  return c.json({
    project: {
      ...project,
      periodStart: project.periodStart.toISOString(),
      periodEnd: project.periodEnd.toISOString(),
      createdAt: project.createdAt.toISOString(),
      updatedAt: project.updatedAt.toISOString()
    }
  }, 201);
});

// PUT /api/projects/:id - Update project
app.put('/:id', async (c) => {
  const userId = c.get('userId');
  const projectId = parseInt(c.req.param('id'));

  if (isNaN(projectId)) {
    return c.json({ error: 'Invalid project ID' }, 400);
  }

  const body = await c.req.json();
  const parsed = updateProjectSchema.safeParse(body);

  if (!parsed.success) {
    return c.json({ error: parsed.error.issues[0].message }, 400);
  }

  const db = createDb(c.env.DB);

  // Check ownership
  const existing = await db.select()
    .from(projects)
    .where(and(
      eq(projects.id, projectId),
      eq(projects.userId, userId),
      isNull(projects.deletedAt)
    ))
    .get();

  if (!existing) {
    return c.json({ error: 'Project not found' }, 404);
  }

  // Build update object
  const updates: Record<string, any> = { updatedAt: new Date() };
  if (parsed.data.clientName) updates.clientName = parsed.data.clientName;
  if (parsed.data.clientEmail) updates.clientEmail = parsed.data.clientEmail;
  if (parsed.data.industry) updates.industry = parsed.data.industry;
  if (parsed.data.periodStart) updates.periodStart = new Date(parsed.data.periodStart);
  if (parsed.data.periodEnd) updates.periodEnd = new Date(parsed.data.periodEnd);

  const updated = await db.update(projects)
    .set(updates)
    .where(eq(projects.id, projectId))
    .returning()
    .get();

  return c.json({
    project: {
      ...updated,
      periodStart: updated.periodStart.toISOString(),
      periodEnd: updated.periodEnd.toISOString(),
      createdAt: updated.createdAt.toISOString(),
      updatedAt: updated.updatedAt.toISOString()
    }
  });
});

// DELETE /api/projects/:id - Soft delete project
app.delete('/:id', async (c) => {
  const userId = c.get('userId');
  const projectId = parseInt(c.req.param('id'));

  if (isNaN(projectId)) {
    return c.json({ error: 'Invalid project ID' }, 400);
  }

  const db = createDb(c.env.DB);

  // Check ownership
  const existing = await db.select()
    .from(projects)
    .where(and(
      eq(projects.id, projectId),
      eq(projects.userId, userId),
      isNull(projects.deletedAt)
    ))
    .get();

  if (!existing) {
    return c.json({ error: 'Project not found' }, 404);
  }

  // Soft delete
  await db.update(projects)
    .set({ deletedAt: new Date(), status: 'deleted' })
    .where(eq(projects.id, projectId));

  return c.json({ success: true });
});

export default app;
```

Update worker/src/index.ts to mount project routes:
```typescript
import projectRoutes from './routes/projects';

// After auth routes
app.route('/api/projects', projectRoutes);
```
  </action>
  <verify>
    - `cd worker && npx tsc --noEmit` shows no type errors
    - `cat worker/src/routes/projects.ts` shows all CRUD endpoints
    - `grep "app.route.*projects" worker/src/index.ts` shows routes mounted
  </verify>
  <done>Project CRUD API complete with validation, ownership checks, and soft delete</done>
</task>

<task type="auto">
  <name>Task 2: Create frontend project hooks and components</name>
  <files>
    frontend/src/hooks/useProjects.ts
    frontend/src/components/ProjectCard.tsx
    frontend/src/pages/Dashboard.tsx
    frontend/src/pages/ProjectForm.tsx
    frontend/src/App.tsx
  </files>
  <action>
Create frontend/src/hooks/useProjects.ts:
```typescript
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { apiFetch } from '../lib/api';

export interface Project {
  id: number;
  userId: number;
  clientName: string;
  clientEmail: string;
  industry: 'real_estate' | 'ecommerce' | 'medical';
  periodStart: string;
  periodEnd: string;
  status: string;
  createdAt: string;
  updatedAt: string;
}

export interface CreateProjectInput {
  clientName: string;
  clientEmail: string;
  industry: 'real_estate' | 'ecommerce' | 'medical';
  periodStart: string;
  periodEnd: string;
}

export function useProjects() {
  return useQuery({
    queryKey: ['projects'],
    queryFn: async () => {
      const data = await apiFetch<{ projects: Project[] }>('/projects');
      return data.projects;
    }
  });
}

export function useProject(id: number | undefined) {
  return useQuery({
    queryKey: ['projects', id],
    queryFn: async () => {
      const data = await apiFetch<{ project: Project }>(`/projects/${id}`);
      return data.project;
    },
    enabled: !!id
  });
}

export function useCreateProject() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (project: CreateProjectInput) => {
      const data = await apiFetch<{ project: Project }>('/projects', {
        method: 'POST',
        body: JSON.stringify(project)
      });
      return data.project;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['projects'] });
    }
  });
}

export function useUpdateProject() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ id, ...updates }: Partial<CreateProjectInput> & { id: number }) => {
      const data = await apiFetch<{ project: Project }>(`/projects/${id}`, {
        method: 'PUT',
        body: JSON.stringify(updates)
      });
      return data.project;
    },
    onSuccess: (_, variables) => {
      queryClient.invalidateQueries({ queryKey: ['projects'] });
      queryClient.invalidateQueries({ queryKey: ['projects', variables.id] });
    }
  });
}

export function useDeleteProject() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (id: number) => {
      await apiFetch(`/projects/${id}`, { method: 'DELETE' });
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['projects'] });
    }
  });
}
```

Create frontend/src/components/ProjectCard.tsx:
```typescript
import { Link } from 'react-router-dom';
import type { Project } from '../hooks/useProjects';

interface ProjectCardProps {
  project: Project;
  onDelete: (id: number) => void;
}

const industryLabels: Record<string, string> = {
  real_estate: 'Real Estate',
  ecommerce: 'E-Commerce / Retail',
  medical: 'Medical / Healthcare'
};

export function ProjectCard({ project, onDelete }: ProjectCardProps) {
  const formatDate = (iso: string) => new Date(iso).toLocaleDateString();

  const handleDelete = () => {
    if (confirm(`Delete project for ${project.clientName}?`)) {
      onDelete(project.id);
    }
  };

  return (
    <div style={{
      border: '1px solid #e5e7eb',
      borderRadius: 8,
      padding: 16,
      backgroundColor: 'white'
    }}>
      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
        <div>
          <h3 style={{ margin: 0, marginBottom: 4 }}>{project.clientName}</h3>
          <p style={{ color: '#666', margin: 0, fontSize: 14 }}>{project.clientEmail}</p>
        </div>
        <span style={{
          backgroundColor: '#e0f2fe',
          color: '#0369a1',
          padding: '4px 8px',
          borderRadius: 4,
          fontSize: 12
        }}>
          {industryLabels[project.industry] || project.industry}
        </span>
      </div>

      <div style={{ marginTop: 12, color: '#666', fontSize: 14 }}>
        <p style={{ margin: 0 }}>
          Period: {formatDate(project.periodStart)} - {formatDate(project.periodEnd)}
        </p>
      </div>

      <div style={{ marginTop: 16, display: 'flex', gap: 8 }}>
        <Link
          to={`/projects/${project.id}`}
          style={{
            padding: '8px 16px',
            backgroundColor: '#2563eb',
            color: 'white',
            textDecoration: 'none',
            borderRadius: 4,
            fontSize: 14
          }}
        >
          Open
        </Link>
        <Link
          to={`/projects/${project.id}/edit`}
          style={{
            padding: '8px 16px',
            backgroundColor: '#f3f4f6',
            color: '#374151',
            textDecoration: 'none',
            borderRadius: 4,
            fontSize: 14
          }}
        >
          Edit
        </Link>
        <button
          onClick={handleDelete}
          style={{
            padding: '8px 16px',
            backgroundColor: 'transparent',
            color: '#dc2626',
            border: '1px solid #dc2626',
            borderRadius: 4,
            fontSize: 14,
            cursor: 'pointer'
          }}
        >
          Delete
        </button>
      </div>
    </div>
  );
}
```

Create frontend/src/pages/Dashboard.tsx:
```typescript
import { Link } from 'react-router-dom';
import { useProjects, useDeleteProject } from '../hooks/useProjects';
import { useAuth } from '../hooks/useAuth';
import { ProjectCard } from '../components/ProjectCard';

export function Dashboard() {
  const { user, logout } = useAuth();
  const { data: projects, isLoading, error } = useProjects();
  const deleteProject = useDeleteProject();

  const handleDelete = (id: number) => {
    deleteProject.mutate(id);
  };

  return (
    <div style={{ maxWidth: 1200, margin: '0 auto', padding: 20 }}>
      <header style={{
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center',
        marginBottom: 32,
        paddingBottom: 16,
        borderBottom: '1px solid #e5e7eb'
      }}>
        <h1 style={{ margin: 0 }}>LeCPA P&L Generator</h1>
        <div style={{ display: 'flex', alignItems: 'center', gap: 16 }}>
          <span style={{ color: '#666' }}>{user?.email}</span>
          <button
            onClick={logout}
            style={{
              padding: '8px 16px',
              backgroundColor: '#f3f4f6',
              border: '1px solid #d1d5db',
              borderRadius: 4,
              cursor: 'pointer'
            }}
          >
            Log out
          </button>
        </div>
      </header>

      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 24 }}>
        <h2 style={{ margin: 0 }}>Projects</h2>
        <Link
          to="/projects/new"
          style={{
            padding: '10px 20px',
            backgroundColor: '#2563eb',
            color: 'white',
            textDecoration: 'none',
            borderRadius: 6,
            fontWeight: 500
          }}
        >
          + New Project
        </Link>
      </div>

      {isLoading && <p>Loading projects...</p>}

      {error && (
        <p style={{ color: 'red' }}>Failed to load projects. Please try again.</p>
      )}

      {projects && projects.length === 0 && (
        <div style={{
          textAlign: 'center',
          padding: 40,
          backgroundColor: '#f9fafb',
          borderRadius: 8
        }}>
          <p style={{ color: '#666', marginBottom: 16 }}>No projects yet.</p>
          <Link
            to="/projects/new"
            style={{ color: '#2563eb' }}
          >
            Create your first project
          </Link>
        </div>
      )}

      {projects && projects.length > 0 && (
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',
          gap: 16
        }}>
          {projects.map(project => (
            <ProjectCard
              key={project.id}
              project={project}
              onDelete={handleDelete}
            />
          ))}
        </div>
      )}
    </div>
  );
}
```

Create frontend/src/pages/ProjectForm.tsx:
```typescript
import { useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';
import { useProject, useCreateProject, useUpdateProject } from '../hooks/useProjects';

const projectSchema = z.object({
  clientName: z.string().min(1, 'Client name is required').max(100),
  clientEmail: z.string().email('Invalid email address'),
  industry: z.enum(['real_estate', 'ecommerce', 'medical'], {
    errorMap: () => ({ message: 'Please select an industry' })
  }),
  periodStart: z.string().min(1, 'Start date is required'),
  periodEnd: z.string().min(1, 'End date is required')
}).refine(data => new Date(data.periodStart) < new Date(data.periodEnd), {
  message: 'End date must be after start date',
  path: ['periodEnd']
});

type ProjectFormData = z.infer<typeof projectSchema>;

export function ProjectForm() {
  const { id } = useParams();
  const navigate = useNavigate();
  const isEdit = !!id;
  const projectId = id ? parseInt(id) : undefined;

  const { data: existingProject, isLoading: loadingProject } = useProject(projectId);
  const createProject = useCreateProject();
  const updateProject = useUpdateProject();

  const {
    register,
    handleSubmit,
    reset,
    formState: { errors, isSubmitting }
  } = useForm<ProjectFormData>({
    resolver: zodResolver(projectSchema),
    defaultValues: {
      clientName: '',
      clientEmail: '',
      industry: undefined,
      periodStart: '',
      periodEnd: ''
    }
  });

  // Populate form when editing
  useEffect(() => {
    if (existingProject) {
      reset({
        clientName: existingProject.clientName,
        clientEmail: existingProject.clientEmail,
        industry: existingProject.industry,
        periodStart: existingProject.periodStart.split('T')[0],
        periodEnd: existingProject.periodEnd.split('T')[0]
      });
    }
  }, [existingProject, reset]);

  const onSubmit = async (data: ProjectFormData) => {
    try {
      if (isEdit && projectId) {
        await updateProject.mutateAsync({ id: projectId, ...data });
      } else {
        await createProject.mutateAsync(data);
      }
      navigate('/dashboard');
    } catch (err) {
      // Error handled by mutation
    }
  };

  if (isEdit && loadingProject) {
    return <div style={{ padding: 20 }}>Loading...</div>;
  }

  const inputStyle = {
    width: '100%',
    padding: 10,
    fontSize: 16,
    border: '1px solid #d1d5db',
    borderRadius: 6,
    boxSizing: 'border-box' as const
  };

  const labelStyle = {
    display: 'block',
    marginBottom: 4,
    fontWeight: 500 as const
  };

  const errorStyle = {
    color: '#dc2626',
    fontSize: 14,
    marginTop: 4
  };

  return (
    <div style={{ maxWidth: 600, margin: '40px auto', padding: 20 }}>
      <h1>{isEdit ? 'Edit Project' : 'New Project'}</h1>

      <form onSubmit={handleSubmit(onSubmit)} style={{ marginTop: 24 }}>
        <div style={{ marginBottom: 20 }}>
          <label style={labelStyle} htmlFor="clientName">Client Name</label>
          <input
            id="clientName"
            type="text"
            {...register('clientName')}
            style={inputStyle}
            placeholder="Acme Corp"
          />
          {errors.clientName && <p style={errorStyle}>{errors.clientName.message}</p>}
        </div>

        <div style={{ marginBottom: 20 }}>
          <label style={labelStyle} htmlFor="clientEmail">Client Email</label>
          <input
            id="clientEmail"
            type="email"
            {...register('clientEmail')}
            style={inputStyle}
            placeholder="client@example.com"
          />
          {errors.clientEmail && <p style={errorStyle}>{errors.clientEmail.message}</p>}
        </div>

        <div style={{ marginBottom: 20 }}>
          <label style={labelStyle} htmlFor="industry">Industry</label>
          <select
            id="industry"
            {...register('industry')}
            style={inputStyle}
          >
            <option value="">Select industry...</option>
            <option value="real_estate">Real Estate</option>
            <option value="ecommerce">E-Commerce / Retail</option>
            <option value="medical">Medical / Healthcare</option>
          </select>
          {errors.industry && <p style={errorStyle}>{errors.industry.message}</p>}
        </div>

        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 16, marginBottom: 20 }}>
          <div>
            <label style={labelStyle} htmlFor="periodStart">Period Start</label>
            <input
              id="periodStart"
              type="date"
              {...register('periodStart')}
              style={inputStyle}
            />
            {errors.periodStart && <p style={errorStyle}>{errors.periodStart.message}</p>}
          </div>
          <div>
            <label style={labelStyle} htmlFor="periodEnd">Period End</label>
            <input
              id="periodEnd"
              type="date"
              {...register('periodEnd')}
              style={inputStyle}
            />
            {errors.periodEnd && <p style={errorStyle}>{errors.periodEnd.message}</p>}
          </div>
        </div>

        {(createProject.error || updateProject.error) && (
          <p style={{ color: '#dc2626', marginBottom: 16 }}>
            {createProject.error?.message || updateProject.error?.message || 'An error occurred'}
          </p>
        )}

        <div style={{ display: 'flex', gap: 12 }}>
          <button
            type="submit"
            disabled={isSubmitting}
            style={{
              padding: '12px 24px',
              backgroundColor: '#2563eb',
              color: 'white',
              border: 'none',
              borderRadius: 6,
              fontSize: 16,
              cursor: isSubmitting ? 'not-allowed' : 'pointer',
              opacity: isSubmitting ? 0.7 : 1
            }}
          >
            {isSubmitting ? 'Saving...' : (isEdit ? 'Update Project' : 'Create Project')}
          </button>
          <button
            type="button"
            onClick={() => navigate('/dashboard')}
            style={{
              padding: '12px 24px',
              backgroundColor: '#f3f4f6',
              color: '#374151',
              border: '1px solid #d1d5db',
              borderRadius: 6,
              fontSize: 16,
              cursor: 'pointer'
            }}
          >
            Cancel
          </button>
        </div>
      </form>
    </div>
  );
}
```

Update frontend/src/App.tsx to add project routes:
```typescript
import { Routes, Route, Navigate } from 'react-router-dom';
import { AuthProvider, useAuth } from './lib/auth-context';
import { Login } from './pages/Login';
import { AuthVerify } from './pages/AuthVerify';
import { Dashboard } from './pages/Dashboard';
import { ProjectForm } from './pages/ProjectForm';

function ProtectedRoute({ children }: { children: React.ReactNode }) {
  const { user, loading } = useAuth();

  if (loading) {
    return <div style={{ padding: 20 }}>Loading...</div>;
  }

  if (!user) {
    return <Navigate to="/login" replace />;
  }

  return <>{children}</>;
}

// Placeholder for project detail page (Phase 2+)
function ProjectDetail() {
  return <div style={{ padding: 20 }}>Project detail coming in Phase 2 (Upload & Parse)</div>;
}

function AppRoutes() {
  return (
    <Routes>
      <Route path="/login" element={<Login />} />
      <Route path="/auth/verify" element={<AuthVerify />} />
      <Route path="/dashboard" element={
        <ProtectedRoute>
          <Dashboard />
        </ProtectedRoute>
      } />
      <Route path="/projects/new" element={
        <ProtectedRoute>
          <ProjectForm />
        </ProtectedRoute>
      } />
      <Route path="/projects/:id/edit" element={
        <ProtectedRoute>
          <ProjectForm />
        </ProtectedRoute>
      } />
      <Route path="/projects/:id" element={
        <ProtectedRoute>
          <ProjectDetail />
        </ProtectedRoute>
      } />
      <Route path="/" element={<Navigate to="/dashboard" replace />} />
    </Routes>
  );
}

export default function App() {
  return (
    <AuthProvider>
      <AppRoutes />
    </AuthProvider>
  );
}
```
  </action>
  <verify>
    - `cd frontend && npx tsc --noEmit` shows no type errors
    - All files exist: hooks/useProjects.ts, pages/Dashboard.tsx, pages/ProjectForm.tsx, components/ProjectCard.tsx
    - `grep -r "useProjects" frontend/src/pages/Dashboard.tsx` shows hook usage
    - `grep -r "/projects" frontend/src/App.tsx` shows all routes defined
  </verify>
  <done>Frontend project management complete with dashboard, create/edit forms, and delete functionality</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **API endpoint tests (requires auth cookie):**
   First, get authenticated (from Plan 02) or test with direct curl by inserting a test user.

   List projects (empty initially):
   ```bash
   curl http://localhost:8787/api/projects \
     -H "Cookie: session=YOUR_JWT"
   ```
   Should return `{"projects":[]}`.

   Create project:
   ```bash
   curl -X POST http://localhost:8787/api/projects \
     -H "Content-Type: application/json" \
     -H "Cookie: session=YOUR_JWT" \
     -d '{"clientName":"Test Corp","clientEmail":"test@corp.com","industry":"real_estate","periodStart":"2024-01-01","periodEnd":"2024-12-31"}'
   ```
   Should return 201 with project object.

2. **Full UI flow:**
   - Login via magic link
   - Dashboard shows "No projects yet"
   - Click "+ New Project"
   - Fill form: client name, email, select industry, date range
   - Submit -> returns to dashboard with project card
   - Click "Edit" -> form populated, make change, save
   - Click "Delete" -> confirm -> project removed from list

3. **Authorization:**
   Try accessing /api/projects without cookie -> should get 401.
   Try accessing /api/projects/999 (non-existent) -> should get 404.
</verification>

<success_criteria>
1. GET /api/projects returns user's non-deleted projects
2. GET /api/projects/:id returns single project (owned by user)
3. POST /api/projects creates project with validation
4. PUT /api/projects/:id updates project (owned by user)
5. DELETE /api/projects/:id soft-deletes project (sets deleted_at)
6. Dashboard displays project cards in responsive grid
7. Create form validates all fields before submission
8. Edit form pre-populates with existing data
9. Delete requires confirmation, removes from list
10. All project routes are protected (redirect to login if unauthenticated)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
